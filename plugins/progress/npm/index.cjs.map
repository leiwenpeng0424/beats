{"version":3,"file":"index.cjs","sources":["../src/index.ts"],"sourcesContent":["import type { Plugin } from \"rollup\";\nimport nodePath from \"node:path\";\n\nexport type BundleStatus = {\n    loaded: number;\n    parsed: number;\n};\n\nexport default function bundleProgress(): Plugin {\n    let cur: string;\n    const bundlesStatus: { [K: string]: BundleStatus } = {};\n\n    return {\n        name: \"bin\",\n        resolveId(id, importer, { isEntry }) {\n            if (isEntry && !importer && nodePath.isAbsolute(id)) {\n                cur = id;\n                bundlesStatus[id] = {\n                    loaded: 0,\n                    parsed: 0,\n                };\n            }\n        },\n\n        load() {\n            if (bundlesStatus[cur]) {\n                bundlesStatus[cur].loaded += 1;\n            }\n        },\n\n        moduleParsed(moduleInfo) {\n            const status = bundlesStatus[cur];\n            if (status) {\n                status.parsed += 1;\n                if (process.stdout.isTTY) {\n                    const relativeModulePath = nodePath.relative(\n                        process.cwd(),\n                        moduleInfo.id,\n                    );\n\n                    const output = `(${status.parsed}/${status.loaded}) ${relativeModulePath}`;\n\n                    process.stdout.clearLine(0);\n                    process.stdout.cursorTo(0);\n                    process.stdout.write(\n                        output.length > process.stdout.columns\n                            ? output.slice(0, process.stdout.columns - 1)\n                            : output,\n                    );\n                }\n            }\n        },\n\n        generateBundle() {\n            if (process.stdout.isTTY) {\n                process.stdout.clearLine(0);\n                process.stdout.cursorTo(0);\n            }\n        },\n    };\n}\n\n"],"names":[],"mappings":";;;;;;AAEe,SAAS,cAAc,GAAG;AACzC,EAAE,IAAI,GAAG,CAAC;AACV,EAAE,MAAM,aAAa,GAAG,EAAE,CAAC;AAC3B,EAAE,OAAO;AACT,IAAI,IAAI,EAAE,KAAK;AACf,IAAI,SAAS,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,OAAO,EAAE,EAAE;AACzC,MAAM,IAAI,OAAO,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE;AAC3D,QAAQ,GAAG,GAAG,EAAE,CAAC;AACjB,QAAQ,aAAa,CAAC,EAAE,CAAC,GAAG;AAC5B,UAAU,MAAM,EAAE,CAAC;AACnB,UAAU,MAAM,EAAE,CAAC;AACnB,SAAS,CAAC;AACV,OAAO;AACP,KAAK;AACL,IAAI,IAAI,GAAG;AACX,MAAM,IAAI,aAAa,CAAC,GAAG,CAAC,EAAE;AAC9B,QAAQ,aAAa,CAAC,GAAG,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC;AACvC,OAAO;AACP,KAAK;AACL,IAAI,YAAY,CAAC,UAAU,EAAE;AAC7B,MAAM,MAAM,MAAM,GAAG,aAAa,CAAC,GAAG,CAAC,CAAC;AACxC,MAAM,IAAI,MAAM,EAAE;AAClB,QAAQ,MAAM,CAAC,MAAM,IAAI,CAAC,CAAC;AAC3B,QAAQ,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE;AAClC,UAAU,MAAM,kBAAkB,GAAG,QAAQ,CAAC,QAAQ;AACtD,YAAY,OAAO,CAAC,GAAG,EAAE;AACzB,YAAY,UAAU,CAAC,EAAE;AACzB,WAAW,CAAC;AACZ,UAAU,MAAM,MAAM,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,kBAAkB,CAAC,CAAC,CAAC;AACrF,UAAU,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;AACtC,UAAU,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;AACrC,UAAU,OAAO,CAAC,MAAM,CAAC,KAAK;AAC9B,YAAY,MAAM,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,OAAO,CAAC,MAAM,CAAC,OAAO,GAAG,CAAC,CAAC,GAAG,MAAM;AACzG,WAAW,CAAC;AACZ,SAAS;AACT,OAAO;AACP,KAAK;AACL,IAAI,cAAc,GAAG;AACrB,MAAM,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE;AAChC,QAAQ,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;AACpC,QAAQ,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;AACnC,OAAO;AACP,KAAK;AACL,GAAG,CAAC;AACJ;;;;"}