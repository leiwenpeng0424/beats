{"version":3,"file":"index.cjs","sources":["../src/index.ts"],"sourcesContent":["import { type IPathObject } from \"@nfts/tsc-json\";\nimport { type Plugin } from \"rollup\";\nimport * as path from \"node:path\";\n\nexport type RollupAliasOptions = { alias: IPathObject };\n\n/**\n * Map alias to realpath.\n * @param alias\n * @returns\n */\nexport const aliasToModulePath = (alias: IPathObject = {}) => {\n    const aliasLen = Object.keys(alias).length;\n\n    return (id: string): string | null => {\n        if (aliasLen === 0) {\n            return null;\n        }\n\n        for (const key in alias) {\n            if (Object.prototype.hasOwnProperty.call(alias, key)) {\n                const element = alias[key];\n\n                if (element.length === 0) {\n                    return null;\n                }\n\n                if (key === id) {\n                    return element[0];\n                }\n\n                const regexp = new RegExp(\n                    `${key.replace(\"/*\", \"/(.+)$\")}`,\n                ).exec(id);\n\n                if (regexp) {\n                    const subpath = regexp[1];\n\n                    return element[0].replace(\"*\", subpath);\n                }\n            }\n        }\n\n        return \"\";\n    };\n};\n\n/**\n * ts-config paths to alias.\n * This plugin need to be the first one of the rollup plugin array.\n * @param alias\n */\nexport function alias({ alias }: RollupAliasOptions): Plugin {\n    const resolve = aliasToModulePath(alias);\n\n    return {\n        name: \"alias\",\n        resolveId: {\n            order: \"pre\",\n            async handler(id, importer) {\n                const moduleId = resolve(id);\n\n                if (moduleId) {\n                    const resolution = await this.resolve(\n                        path.resolve(process.cwd(), moduleId),\n                        importer,\n                        {\n                            skipSelf: true,\n                        },\n                    );\n\n                    return resolution;\n                }\n                return null;\n            },\n        },\n    };\n}\n\n"],"names":["path"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AACY,MAAC,iBAAiB,GAAG,CAAC,MAAM,GAAG,EAAE,KAAK;AAClD,EAAE,MAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC;AAC9C,EAAE,OAAO,CAAC,EAAE,KAAK;AACjB,IAAI,IAAI,QAAQ,KAAK,CAAC,EAAE;AACxB,MAAM,OAAO,IAAI,CAAC;AAClB,KAAK;AACL,IAAI,KAAK,MAAM,GAAG,IAAI,MAAM,EAAE;AAC9B,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;AAC7D,QAAQ,MAAM,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;AACpC,QAAQ,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;AAClC,UAAU,OAAO,IAAI,CAAC;AACtB,SAAS;AACT,QAAQ,IAAI,GAAG,KAAK,EAAE,EAAE;AACxB,UAAU,OAAO,OAAO,CAAC,CAAC,CAAC,CAAC;AAC5B,SAAS;AACT,QAAQ,MAAM,MAAM,GAAG,IAAI,MAAM;AACjC,UAAU,CAAC,EAAE,GAAG,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC,CAAC;AAC1C,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AACnB,QAAQ,IAAI,MAAM,EAAE;AACpB,UAAU,MAAM,OAAO,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;AACpC,UAAU,OAAO,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;AAClD,SAAS;AACT,OAAO;AACP,KAAK;AACL,IAAI,OAAO,EAAE,CAAC;AACd,GAAG,CAAC;AACJ,EAAE;AACK,SAAS,KAAK,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE;AACzC,EAAE,MAAM,OAAO,GAAG,iBAAiB,CAAC,MAAM,CAAC,CAAC;AAC5C,EAAE,OAAO;AACT,IAAI,IAAI,EAAE,OAAO;AACjB,IAAI,SAAS,EAAE;AACf,MAAM,KAAK,EAAE,KAAK;AAClB,MAAM,MAAM,OAAO,CAAC,EAAE,EAAE,QAAQ,EAAE;AAClC,QAAQ,MAAM,QAAQ,GAAG,OAAO,CAAC,EAAE,CAAC,CAAC;AACrC,QAAQ,IAAI,QAAQ,EAAE;AACtB,UAAU,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,OAAO;AAC/C,YAAYA,eAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,QAAQ,CAAC;AACjD,YAAY,QAAQ;AACpB,YAAY;AACZ,cAAc,QAAQ,EAAE,IAAI;AAC5B,aAAa;AACb,WAAW,CAAC;AACZ,UAAU,OAAO,UAAU,CAAC;AAC5B,SAAS;AACT,QAAQ,OAAO,IAAI,CAAC;AACpB,OAAO;AACP,KAAK;AACL,GAAG,CAAC;AACJ;;;;;"}